<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Your Phalahaar cart - review items, apply coupons, and checkout.">
    <title>Shopping Cart - Phalahaar</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" />
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="scroll-progress"></div>

    <section id="header">
        <div id="logo"><img src="image/LOGO2.png" alt="Phalahaar Logo">
            <h1>Phalahaar</h1>
        </div>
        <div class="header-controls">
            <button class="theme-toggle" aria-label="Toggle dark mode"><i class="fa-solid fa-moon"></i></button>
            <button class="hamburger" aria-label="Menu"><span></span><span></span><span></span></button>
        </div>
        <ul id="navbar">
            <li><a href="./index.html">Home</a></li>
            <li><a href="./about.html">About</a></li>
            <li><a href="./outlet.html">Outlet</a></li>
            <li><a href="./product.html">Product</a></li>
            <li><a href="./contact.html">Contact</a></li>
            <li><a href="./faq.html">FAQ</a></li>
            <li><a href="./wishlist.html" class="cart-link"><i class="fa-solid fa-heart"></i><span
                        class="wishlist-count"></span></a></li>
            <li><a href="./cart.html" class="cart-link active"><i class="fa-solid fa-cart-shopping"></i><span
                        class="cart-badge"></span></a></li>
        </ul>
    </section>

    <div class="breadcrumbs"><a href="index.html">Home</a> <span>‚Ä∫</span> <strong>Shopping Cart</strong></div>

    <section id="cart" class="section-p1">
        <h1 style="font-size:clamp(1.8rem,3vw,2.5rem);color:var(--primary);font-weight:800;margin-bottom:20px;">Your
            Shopping Cart</h1>
        <table>
            <thead>
                <tr>
                    <td>Remove</td>
                    <td>Image</td>
                    <td>Product</td>
                    <td>Price</td>
                    <td>Quantity</td>
                    <td>Subtotal</td>
                </tr>
            </thead>
            <tbody id="cart-items"></tbody>
        </table>
    </section>

    <section id="cart-add" class="section-p1">
        <div id="coupon">
            <h3>Apply Coupon</h3>
            <div><input type="text" id="coupon-input" placeholder="Enter coupon code (e.g. FRESH50)"><button
                    id="apply-coupon-btn">Apply</button></div>
            <p id="coupon-msg" style="margin-top:8px;font-size:0.9rem;display:none;"></p>
        </div>
        <div id="subtotal">
            <h3>Cart Totals</h3>
            <table>
                <tr>
                    <td>Cart Subtotal</td>
                    <td id="cart-subtotal">‚Çπ0</td>
                </tr>
                <tr id="coupon-discount-row" style="display:none;">
                    <td>Coupon Discount (FRESH50 ‚Äì 10%)</td>
                    <td id="coupon-discount" style="color:#e74c3c;">‚àí‚Çπ0</td>
                </tr>
                <tr>
                    <td>Shipping</td>
                    <td id="cart-shipping">Free</td>
                </tr>
                <tr>
                    <td><strong>Total</strong></td>
                    <td><strong id="cart-total">‚Çπ0</strong></td>
                </tr>
            </table>
            <button onclick="window.showToast('Checkout coming soon!','üöÄ')">Proceed to Checkout</button>
        </div>
    </section>

    <footer class="footer">
        <div class="footer-wrapper">
            <div class="footer-about">
                <h2>Phalahaar</h2>
                <p>Your trusted source for fresh, organic fruits delivered with care.</p>
                <div class="footer-contact">
                    <p><strong>Address:</strong> Balaji Residence, Sakhipada, Sambalpur</p>
                    <p><strong>Phone:</strong> +91 91******27</p>
                </div>
            </div>
            <nav class="footer-links">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="product.html">Products</a></li>
                    <li><a href="faq.html">FAQ</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </nav>
            <div class="footer-social">
                <h3>Follow Us</h3>
                <div class="social-icons"><a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a><a
                        href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a><a href="#"
                        aria-label="Instagram"><i class="fab fa-instagram"></i></a></div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Pratyush Panda - Phalahaar. All rights reserved.</p>
        </div>
    </footer>

    <a href="https://wa.me/91******27" target="_blank" class="whatsapp-float" aria-label="Chat on WhatsApp"><i
            class="fab fa-whatsapp"></i></a>
    <button class="back-to-top" aria-label="Back to top"><i class="fa-solid fa-arrow-up"></i></button>

    <script src="app.js"></script>
    <script>
        let couponApplied = false;

        document.addEventListener('DOMContentLoaded', () => {
            renderCart();

            // Coupon apply button
            document.getElementById('apply-coupon-btn').addEventListener('click', applyCoupon);
            // Allow pressing Enter in coupon input
            document.getElementById('coupon-input').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') applyCoupon();
            });
        });

        function applyCoupon() {
            const input = document.getElementById('coupon-input');
            const msg = document.getElementById('coupon-msg');
            const code = input.value.trim().toUpperCase();

            if (code === 'FRESH50') {
                couponApplied = true;
                input.disabled = true;
                document.getElementById('apply-coupon-btn').textContent = 'Remove';
                document.getElementById('apply-coupon-btn').removeEventListener('click', applyCoupon);
                document.getElementById('apply-coupon-btn').addEventListener('click', removeCoupon);
                msg.textContent = '‚úÖ Coupon FRESH50 applied! You get 10% off.';
                msg.style.color = '#27ae60';
                msg.style.display = 'block';
                if (window.showToast) window.showToast('Coupon FRESH50 applied! üéâ', 'üéâ');
                renderCart();
            } else if (code === '') {
                msg.textContent = '‚ö†Ô∏è Please enter a coupon code.';
                msg.style.color = '#e67e22';
                msg.style.display = 'block';
            } else {
                msg.textContent = '‚ùå Invalid coupon code. Try FRESH50.';
                msg.style.color = '#e74c3c';
                msg.style.display = 'block';
                if (window.showToast) window.showToast('Invalid coupon code!', '‚ùå');
            }
        }

        function removeCoupon() {
            couponApplied = false;
            const input = document.getElementById('coupon-input');
            const msg = document.getElementById('coupon-msg');
            input.disabled = false;
            input.value = '';
            document.getElementById('apply-coupon-btn').textContent = 'Apply';
            document.getElementById('apply-coupon-btn').removeEventListener('click', removeCoupon);
            document.getElementById('apply-coupon-btn').addEventListener('click', applyCoupon);
            msg.textContent = 'Coupon removed.';
            msg.style.color = '#999';
            msg.style.display = 'block';
            if (window.showToast) window.showToast('Coupon removed', 'üóëÔ∏è');
            renderCart();
        }

        function renderCart() {
            let cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const tbody = document.getElementById('cart-items');
            tbody.innerHTML = '';

            const couponDiscountRow = document.getElementById('coupon-discount-row');

            if (cart.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6"><div class="empty-cart"><div class="empty-icon">üõí</div><p>Your cart is empty</p><a href="product.html" class="btn-primary">Browse Products</a></div></td></tr>';
                document.getElementById('cart-subtotal').textContent = '‚Çπ0';
                document.getElementById('cart-total').textContent = '‚Çπ0';
                couponDiscountRow.style.display = 'none';
                document.getElementById('cart-shipping').textContent = 'Free';
                return;
            }

            let subtotal = 0;
            cart.forEach((item, idx) => {
                const s = item.price * item.quantity; subtotal += s;
                const tr = document.createElement('tr');
                tr.innerHTML = `<td><button class="remove-btn" data-idx="${idx}"><i class="fa-regular fa-circle-xmark"></i></button></td><td><img src="${item.img}" alt="${item.name}"></td><td>${item.name}</td><td>‚Çπ${item.price}</td><td><input type="number" min="1" value="${item.quantity}" class="qty-input" data-idx="${idx}" style="width:60px;padding:6px;border:2px solid var(--border);border-radius:8px;text-align:center;background:var(--bg-card);color:var(--text)"></td><td>‚Çπ${s}</td>`;
                tbody.appendChild(tr);
            });

            document.getElementById('cart-subtotal').textContent = '‚Çπ' + subtotal;

            let total = subtotal;

            if (couponApplied) {
                // 10% coupon discount on subtotal
                const couponDisc = Math.round(subtotal * 0.10);
                total = subtotal - couponDisc;

                document.getElementById('coupon-discount').textContent = '‚àí‚Çπ' + couponDisc;
                couponDiscountRow.style.display = '';
            } else {
                couponDiscountRow.style.display = 'none';
            }

            // Shipping: free for ‚Çπ500+, otherwise ‚Çπ40
            const shippingEl = document.getElementById('cart-shipping');
            let shipping = 0;
            if (total < 500) {
                shipping = 40;
                shippingEl.textContent = '‚Çπ40';
            } else {
                shippingEl.textContent = 'Free';
            }
            total += shipping;

            document.getElementById('cart-total').textContent = '‚Çπ' + total;

            // Remove item buttons
            document.querySelectorAll('.remove-btn').forEach(b => b.addEventListener('click', () => {
                let c = JSON.parse(localStorage.getItem('cart') || '[]');
                const n = c[b.dataset.idx]?.name;
                c.splice(parseInt(b.dataset.idx), 1);
                localStorage.setItem('cart', JSON.stringify(c));
                if (window.showToast) window.showToast(`${n} removed`, 'üóëÔ∏è');
                renderCart();
                const badge = document.querySelector('.cart-badge');
                if (badge) { const cnt = c.reduce((s, i) => s + i.quantity, 0); badge.textContent = cnt > 0 ? cnt : ''; badge.setAttribute('data-count', cnt); }
            }));

            // Quantity change
            document.querySelectorAll('.qty-input').forEach(i => i.addEventListener('change', () => {
                let c = JSON.parse(localStorage.getItem('cart') || '[]');
                c[i.dataset.idx].quantity = Math.max(1, parseInt(i.value) || 1);
                localStorage.setItem('cart', JSON.stringify(c));
                renderCart();
                const badge = document.querySelector('.cart-badge');
                if (badge) { const cnt = c.reduce((s, x) => s + x.quantity, 0); badge.textContent = cnt > 0 ? cnt : ''; badge.setAttribute('data-count', cnt); }
            }));
        }
    </script>
</body>

</html>